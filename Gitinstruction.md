# Инструкция по git командам

![Markdown](https://avatars.mds.yandex.net/i?id=b11d26714cc781c76b3c5f4085d84d05-4316934-images-thumbs&n=13)

 **Git** — система контроля версий (файлов). Что-то вроде возможности сохраняться в компьютерных играх (в Git эквивалент игрового сохранения — коммит). Важно: добавление файлов к «сохранению» двухступенчатое: сначала добавляем файл в индекс (git add), потом «сохраняем» (git commit).

Любой файл в директории существующего репозитория может находиться или не находиться под версионным контролем (отслеживаемые и неотслеживаемые).

Отслеживаемые файлы могут быть в 3-х состояниях: неизменённые, изменённые, проиндексированные (готовые к коммиту).

## Указатели 

***
**HEAD** — указатель на текущий коммит или на текущую ветку (то есть, в любом случае, на коммит). Указывает на родителя коммита, который будет создан следующим.

**ORIG_HEAD** — указатель на коммит, с которого вы только что переместили HEAD (командой git reset ..., например).

**Ветка (master, develop etc.)** — указатель на коммит. При добавлении коммита, указатель ветки перемещается с родительского коммита на новый.

## Настройки

Перед началом работы нужно выполнить некоторые настройки:

```python
git config --global user.name "Your Name" # указать имя, которым будут подписаны коммиты
git config --global user.email "e@w.com"  # указать электропочту, которая будет в описании коммитера
```
Если вы в Windows:

```python
git config --global core.autocrlf true # включить преобразование окончаний строк из CRLF в LF
```
## Указание неотслеживаемых файлов
```python
Файлы и директории, которые не нужно включать в репозиторий, указываются в файле .gitignore. Обычно это устанавливаемые зависимости (node_modules/, bower_components/), готовая сборка build/ или dist/ и подобные, создаваемые при установке или запуске. Каждый файл или директория указываются с новой строки, возможно использование шаблонов.
```

## Создать новый репозиторий

* *git init* - Команда, инициализирующая репозиторий в текущей папке;

* git init folder-name создать новый проект в указанной директории

## Просмотр изменений
---

* git diff                # сравнить рабочую директорию и индекс (неотслеживаемые файлы ИГНОРИРУЮТСЯ)

* git diff --color-words  # сравнить рабочую директорию и индекс, показать отличия в словах (неотслеживаемые файлы ИГНОРИРУЮТСЯ)

* git diff index.html     # сравнить файл из рабочей директории и индекс

* git diff HEAD           # сравнить рабочую директорию и коммит, на который указывает HEAD (неотслеживаемые файлы ИГНОРИРУЮТСЯ)

* git diff --staged       # сравнить индекс и коммит с HEAD

* git diff master feature # посмотреть что сделано в ветке feature по сравнению с веткой master

* git diff --name-only master feature # посмотреть что сделано в ветке feature по сравнению с веткой master, показать только имена файлов

* git diff master...feature # посмотреть что сделано в ветке feature с момента (коммита) расхождения с master
---
## Добавление изменений в индекс
git add .        # добавить в индекс все новые, изменённые, удалённые файлы из текущей директории и её поддиректорий

git add text.txt # добавить в индекс указанный файл (был изменён, был удалён или это новый файл)

git add -i       # запустить интерактивную оболочку для добавления в индекс только выбранных файлов

git add -p       # показать новые/изменённые файлы по очереди с указанием их изменений и вопросом об отслеживании/индексировании

---

## Удаление изменений из индекса

git reset            # убрать из индекса все добавленные в него изменения (в рабочей директории все изменения сохранятся), антипод git add

git reset readme.txt # убрать из индекса изменения указанного файла (в рабочей директории изменения сохранятся)


---
## Отмена изменений

git checkout text.txt      # ОПАСНО: отменить изменения в файле, вернуть состояние файла, имеющееся в индексе

git reset --hard           # ОПАСНО: отменить изменения; вернуть то, что в коммите, на который указывает HEAD (незакомиченные изменения удалены из индекса и из рабочей директории, неотслеживаемые файлы останутся на месте)

git clean -df              # удалить неотслеживаемые файлы и директории

---

## Коммиты
git commit -m "Name of commit"    # зафиксировать в коммите проиндексированные изменения (закоммитить), добавить сообщение

git commit -a -m "Name of commit" # проиндексировать отслеживаемые файлы (ТОЛЬКО отслеживаемые, но НЕ новые файлы) и закоммитить, добавить сообщение

---
## Переключиться на другой коммит и продолжить работу с него
git checkout -b new-branch 5589877   # создать ветку new-branch, начинающуюся с коммита c хешем 5589877 (переместить HEAD на указанный коммит, рабочую директорию вернуть к состоянию, на момент этого коммита, создать указатель на этот коммит (ветку) с указанным именем)

---

## История коммитов

git log master             # показать коммиты в указанной ветке

git log -2                 # показать последние 2 коммита в активной ветке

git log -2 --stat          # показать последние 2 коммита и статистику внесенных ими изменений

git log -p -22             # показать последние 22 коммита и внесенную ими разницу на уровне строк

git log --graph -10        # показать последние 10 коммитов с ASCII-представлением ветвления

git log --since=2.weeks    # показать коммиты за последние 2 недели

git log --after '2018-06-30' # показать коммиты, сделанные после указанной даты

git log index.html         # показать историю изменений файла index.html (только коммиты)

git log -5 index.html      # показать историю изменений файла index.html, последние 5 коммитов (только коммиты)

git log -p index.html      # показать историю изменений файла index.html (коммиты и изменения)

git log -G'myFunction' -p  # показать все коммиты, в которых менялись строки с myFunction (в кавычках регулярное выражение)

git log -L '/<head>/','/<\/head>/':index.html # показать изменения от указанного до указанного регулярных выражений в указанном файле

git log --grep fix         # показать коммиты, в описании которых есть буквосочетание fix (регистрозависимо, только коммиты текущей ветки)

git log --grep fix -i      # показать коммиты, в описании которых есть буквосочетание fix (регистроНЕзависимо, только коммиты текущей ветки)

git log --grep 'fix(ing|me)' -P # показать коммиты, в описании которых есть совпадения для регулярного выражения (только коммиты текущей ветки)

git log --pretty=format:"%h - %an, %ar : %s" -4 # показать последние 4 коммита с форматированием выводимых данных

git log --pretty=format:"%h %ad | %s%d [%an]" --graph --date=short # мой формат вывода, висящий на алиасе оболочки

git log master..branch_99  # показать коммиты из ветки branch_99, которые не влиты в master

git log branch_99..master  # показать коммиты из ветки master, которые не влиты в branch_99

git log master...branch_99 --boundary -- graph # показать коммиты из указанных веток, начиная с их расхождения (коммит расхождения будет показан)

---Ветки и теги
Список всех существующих веток
$ git branch -av
Переключение в HEAD ветки
$ git checkout <ветка>
Создать новую ветку на основе текущей HEAD
$ git branch <новая-ветка>
Создать новую ветку и сразу переключится в нее
$ git checkout -b <новая-ветка>
Создать новую отслеживаемую ветку на основе удаленной ветки
$ git checkout --track <репо/ветка>
Удалить локальную ветку
$ git branch -d <ветка>
Присвоить текущему коммиту тег
$ git tag <имя-тега>